<%
    require 'securerandom'
    @token = SecureRandom.alphanumeric(30)
    session[:csrf_token]= @token
%>
<form id='line_sign_in_form' method='GET' action='https://access.line.me/oauth2/v2.1/authorize' enctype='application/x-www-form-urlencoded'>
    <button type='submit'>LINEでログイン</span></button>
    <input type='hidden' name='state' value='<%= @token %>'>
    <input type='hidden' name='response_type' value='code'>
    <input type='hidden' name='client_id' value='<%= LINE_CLIENT_ID %>'>
    <input type='hidden' name='scope' value='<%= LINE_SCOPE %>'>
    <input type='hidden' name='nonce' value='<%= LINE_NONCE %>'>
    <input type='hidden' name='redirect_uri' value='<%= LINE_REDIRECT_URL %>'>
</form>